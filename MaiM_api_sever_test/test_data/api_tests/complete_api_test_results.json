{
  "test_run": "完整 API 测试流程",
  "timestamp": "2025-11-26T02:21:33.910942",
  "test_steps": [
    {
      "step": 1,
      "description": "健康检查",
      "result": {
        "endpoint": "/api/v1/health",
        "method": "GET",
        "port": 18000,
        "status_code": 404,
        "headers": {
          "date": "Tue, 25 Nov 2025 18:21:32 GMT",
          "server": "uvicorn",
          "content-length": "22",
          "content-type": "application/json"
        },
        "body": {
          "detail": "Not Found"
        },
        "success": false
      }
    },
    {
      "step": 2,
      "description": "获取 Agent 模板",
      "result": {
        "endpoint": "/api/v1/agents/templates",
        "method": "GET",
        "port": 18000,
        "status_code": 200,
        "headers": {
          "date": "Tue, 25 Nov 2025 18:21:32 GMT",
          "server": "uvicorn",
          "content-length": "4592",
          "content-type": "application/json"
        },
        "body": [
          {
            "template_id": "friendly_assistant",
            "name": "友好助手",
            "description": "一个友好、乐于助人的AI助手，适合日常对话和基础问答",
            "category": "general",
            "tags": [
              "友好",
              "助手",
              "日常"
            ],
            "is_active": true,
            "is_system": true,
            "usage_count": 0,
            "persona": "你是一个友好、耐心、乐于助人的AI助手。你喜欢与人交流，总是以积极的态度回答问题，并且善于倾听和理解用户的需求。",
            "personality_traits": {
              "友好度": 9,
              "专业性": 7,
              "幽默感": 6,
              "耐心": 10,
              "创造力": 7
            },
            "response_style": "温和友好，使用简单的语言，适当使用表情符号",
            "memory_config": {
              "long_term_memory": true,
              "short_term_memory": true,
              "memory_retention_days": 30,
              "emotion_memory": true
            },
            "plugin_config": [
              "memory",
              "emoji",
              "expression"
            ],
            "config_schema": null,
            "default_config": null,
            "created_by": "system",
            "created_at": "2025-11-23T19:09:11.431058",
            "updated_at": "2025-11-23T19:09:11.431058"
          },
          {
            "template_id": "professional_expert",
            "name": "专业专家",
            "description": "一个专业、严谨的AI专家，适合专业领域咨询和技术支持",
            "category": "professional",
            "tags": [
              "专业",
              "专家",
              "技术"
            ],
            "is_active": true,
            "is_system": true,
            "usage_count": 0,
            "persona": "你是一个专业、严谨的AI专家。你在多个领域都有深入的知识，总是提供准确、详细的回答。你注重逻辑和事实，善于分析复杂问题。",
            "personality_traits": {
              "友好度": 6,
              "专业性": 10,
              "幽默感": 4,
              "耐心": 8,
              "创造力": 6
            },
            "response_style": "专业严谨，使用准确的专业术语，结构化回答",
            "memory_config": {
              "long_term_memory": true,
              "short_term_memory": true,
              "memory_retention_days": 90,
              "emotion_memory": false
            },
            "plugin_config": [
              "memory",
              "knowledge"
            ],
            "config_schema": null,
            "default_config": null,
            "created_by": "system",
            "created_at": "2025-11-23T19:09:11.437056",
            "updated_at": "2025-11-23T19:09:11.437056"
          },
          {
            "template_id": "creative_companion",
            "name": "创意伙伴",
            "description": "一个富有创造力和想象力的AI伙伴，适合创意灵感和艺术创作",
            "category": "entertainment",
            "tags": [
              "创意",
              "艺术",
              "灵感"
            ],
            "is_active": true,
            "is_system": true,
            "usage_count": 0,
            "persona": "你是一个富有创造力和想象力的AI伙伴。你喜欢探索新的想法，善于激发创意灵感，并且能够从多个角度思考问题。",
            "personality_traits": {
              "友好度": 8,
              "专业性": 6,
              "幽默感": 8,
              "耐心": 7,
              "创造力": 10
            },
            "response_style": "富有想象力，使用生动的描述，鼓励创意思维",
            "memory_config": {
              "long_term_memory": true,
              "short_term_memory": true,
              "memory_retention_days": 60,
              "emotion_memory": true
            },
            "plugin_config": [
              "memory",
              "emoji",
              "expression",
              "creative"
            ],
            "config_schema": null,
            "default_config": null,
            "created_by": "system",
            "created_at": "2025-11-23T19:09:11.438055",
            "updated_at": "2025-11-23T19:09:11.438055"
          },
          {
            "template_id": "caring_friend",
            "name": "贴心朋友",
            "description": "一个温暖、贴心的AI朋友，适合情感陪伴和心理支持",
            "category": "general",
            "tags": [
              "贴心",
              "朋友",
              "情感"
            ],
            "is_active": true,
            "is_system": true,
            "usage_count": 0,
            "persona": "你是一个温暖、贴心的AI朋友。你善于倾听，理解他人的情感，总是给予关心和支持。你重视情感交流，营造安全、温暖的对话环境。",
            "personality_traits": {
              "友好度": 10,
              "专业性": 5,
              "幽默感": 7,
              "耐心": 10,
              "创造力": 6
            },
            "response_style": "温暖体贴，使用柔和的语言，关注情感需求",
            "memory_config": {
              "long_term_memory": true,
              "short_term_memory": true,
              "memory_retention_days": 120,
              "emotion_memory": true
            },
            "plugin_config": [
              "memory",
              "emoji",
              "emotion"
            ],
            "config_schema": null,
            "default_config": null,
            "created_by": "system",
            "created_at": "2025-11-23T19:09:11.439071",
            "updated_at": "2025-11-23T19:09:11.439071"
          },
          {
            "template_id": "efficient_helper",
            "name": "高效助手",
            "description": "一个高效、简洁的AI助手，适合快速解决问题和任务执行",
            "category": "professional",
            "tags": [
              "高效",
              "简洁",
              "任务"
            ],
            "is_active": true,
            "is_system": true,
            "usage_count": 0,
            "persona": "你是一个高效、简洁的AI助手。你专注于快速解决问题，提供直接的答案和可行的建议。你注重效率，避免不必要的复杂化。",
            "personality_traits": {
              "友好度": 7,
              "专业性": 8,
              "幽默感": 5,
              "耐心": 6,
              "创造力": 5
            },
            "response_style": "简洁直接，使用清晰的结构，重点突出",
            "memory_config": {
              "long_term_memory": false,
              "short_term_memory": true,
              "memory_retention_days": 7,
              "emotion_memory": false
            },
            "plugin_config": [
              "memory",
              "task"
            ],
            "config_schema": null,
            "default_config": null,
            "created_by": "system",
            "created_at": "2025-11-23T19:09:11.441074",
            "updated_at": "2025-11-23T19:09:11.441074"
          }
        ],
        "success": true
      }
    },
    {
      "step": 3,
      "description": "用户注册",
      "result": {
        "endpoint": "/api/v1/auth/register",
        "method": "POST",
        "port": 18000,
        "status_code": 409,
        "headers": {
          "date": "Tue, 25 Nov 2025 18:21:32 GMT",
          "server": "uvicorn",
          "content-length": "31",
          "content-type": "application/json"
        },
        "body": {
          "detail": "用户名已存在"
        },
        "success": false
      }
    },
    {
      "step": 4,
      "description": "用户登录",
      "result": {
        "endpoint": "/api/v1/auth/login",
        "method": "POST",
        "port": 18000,
        "status_code": 200,
        "headers": {
          "date": "Tue, 25 Nov 2025 18:21:32 GMT",
          "server": "uvicorn",
          "content-length": "949",
          "content-type": "application/json"
        },
        "body": {
          "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoidXNlcl8xODUwZmQ3YzExMmE5Mjc2IiwidGVuYW50X2lkIjoidGVuYW50XzIwZjdmMmM0NzgyNTUzMWEiLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzY0MTgxMjk0LCJpYXQiOjE3NjQwOTQ4OTR9.gApw7lXOmyYbwvcuc0DG5__rNJTDsjtD6ikuXhhnUyU",
          "refresh_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoidXNlcl8xODUwZmQ3YzExMmE5Mjc2IiwidGVuYW50X2lkIjoidGVuYW50XzIwZjdmMmM0NzgyNTUzMWEiLCJ0eXBlIjoicmVmcmVzaCIsImV4cCI6MTc2NjY4Njg5NCwiaWF0IjoxNzY0MDk0ODk0fQ.hJqLEhNiOqjwgww3PB1dT5ZfvIEDVhkbX8GMhVVebYY",
          "token_type": "bearer",
          "expires_in": 86400,
          "user_info": {
            "user_id": "user_1850fd7c112a9276",
            "tenant_id": "tenant_20f7f2c47825531a",
            "username": "maple123",
            "email": "maple123@example.com",
            "phone": null,
            "tenant_name": "mapleの测试租户",
            "tenant_type": "personal",
            "api_key": "mb_n0fsRxJ3P9M4m4ofgDnfJVMDUHHmjnQLoDMmDiSE0Uc",
            "status": "active",
            "created_at": "2025-11-25T16:56:30.712857",
            "last_login_at": "2025-11-25T18:21:34.021283"
          }
        },
        "success": true
      }
    },
    {
      "step": 5,
      "description": "获取当前用户信息",
      "result": {
        "endpoint": "/api/v1/auth/me",
        "method": "GET",
        "port": 18000,
        "status_code": 200,
        "headers": {
          "date": "Tue, 25 Nov 2025 18:21:34 GMT",
          "server": "uvicorn",
          "content-length": "365",
          "content-type": "application/json"
        },
        "body": {
          "user_id": "user_1850fd7c112a9276",
          "tenant_id": "tenant_20f7f2c47825531a",
          "username": "maple123",
          "email": "maple123@example.com",
          "phone": null,
          "tenant_name": "mapleの测试租户",
          "tenant_type": "personal",
          "api_key": "mb_n0fsRxJ3P9M4m4ofgDnfJVMDUHHmjnQLoDMmDiSE0Uc",
          "status": "active",
          "created_at": "2025-11-25T16:56:30.712857",
          "last_login_at": "2025-11-25T18:21:34.021283"
        },
        "success": true
      }
    },
    {
      "step": 6,
      "description": "获取租户信息",
      "result": {
        "endpoint": "/api/v1/tenant",
        "method": "GET",
        "port": 18000,
        "status_code": 200,
        "headers": {
          "date": "Tue, 25 Nov 2025 18:21:34 GMT",
          "server": "uvicorn",
          "content-length": "462",
          "content-type": "application/json"
        },
        "body": {
          "tenant_id": "tenant_20f7f2c47825531a",
          "user_id": "user_1850fd7c112a9276",
          "username": "maple123",
          "email": "maple123@example.com",
          "phone": null,
          "tenant_name": "mapleの测试租户",
          "tenant_type": "personal",
          "tenant_config": null,
          "api_key": "mb_n0fsRxJ3P9M4m4ofgDnfJVMDUHHmjnQLoDMmDiSE0Uc",
          "status": "active",
          "permissions": [],
          "created_at": "2025-11-25T16:56:30.712857",
          "updated_at": "2025-11-25T16:56:30.712857",
          "last_login_at": "2025-11-25T18:21:34.021283",
          "login_count": 13
        },
        "success": true
      }
    },
    {
      "step": 7,
      "description": "获取租户统计信息",
      "result": {
        "endpoint": "/api/v1/tenant/stats",
        "method": "GET",
        "port": 18000,
        "status_code": 200,
        "headers": {
          "date": "Tue, 25 Nov 2025 18:21:34 GMT",
          "server": "uvicorn",
          "content-length": "168",
          "content-type": "application/json"
        },
        "body": {
          "tenant_id": "tenant_20f7f2c47825531a",
          "tenant_name": "mapleの测试租户",
          "total_agents": 0,
          "total_messages": 0,
          "total_api_calls": 0,
          "total_cost": 0.0,
          "last_active": null
        },
        "success": true
      }
    },
    {
      "step": 8,
      "description": "获取 Agent 列表",
      "result": {
        "endpoint": "/api/v1/agents",
        "method": "GET",
        "port": 18000,
        "status_code": 500,
        "headers": {
          "date": "Tue, 25 Nov 2025 18:21:34 GMT",
          "server": "uvicorn",
          "content-length": "21",
          "content-type": "text/plain; charset=utf-8"
        },
        "body": "Internal Server Error",
        "success": false
      }
    },
    {
      "step": 9,
      "description": "创建 Agent",
      "result": {
        "endpoint": "/api/v1/agents",
        "method": "POST",
        "port": 18000,
        "status_code": 405,
        "headers": {
          "date": "Tue, 25 Nov 2025 18:21:34 GMT",
          "server": "uvicorn",
          "allow": "GET",
          "content-length": "31",
          "content-type": "application/json"
        },
        "body": {
          "detail": "Method Not Allowed"
        },
        "success": false
      }
    }
  ],
  "extracted_tenant_info": {
    "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoidXNlcl8xODUwZmQ3YzExMmE5Mjc2IiwidGVuYW50X2lkIjoidGVuYW50XzIwZjdmMmM0NzgyNTUzMWEiLCJ0eXBlIjoiYWNjZXNzIiwiZXhwIjoxNzY0MTgxMjk0LCJpYXQiOjE3NjQwOTQ4OTR9.gApw7lXOmyYbwvcuc0DG5__rNJTDsjtD6ikuXhhnUyU"
  }
}